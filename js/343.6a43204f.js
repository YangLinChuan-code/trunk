"use strict";(globalThis["webpackChunktrunk"]=globalThis["webpackChunktrunk"]||[]).push([[343],{3748:(e,t,a)=>{a.r(t),a.d(t,{default:()=>K});var l=a(9835),n=(a(9665),a(6970)),o=a(499),i=a(1957),s=a(6827),r=a(9302),p=a(8339),d=a(9185),c=a(7712);const u={class:"text-h6"},g={class:"row justify-between q-mb-md"},m={class:"q-gutter-x-sm"},w={class:"col-4 q-mr-md"},b={class:"q-gutter-x-sm"},_={class:"text-subtitle2"},f={class:"text-negative"},k={__name:"Coupon",setup(e){const{t}=(0,c.QT)(),a=(0,r.Z)(),k=(0,l.f3)("post"),h=(0,p.tv)(),W=(0,o.qj)({columns:[{name:"id",label:"ID",align:"center",sortable:!0},{name:"title",label:t("標題"),align:"center"},{name:"status",label:t("狀態"),align:"center",sortable:!0},{name:"type",label:t("類別"),align:"center"},{name:"code",label:t("優惠碼"),align:"center",sortable:!0},{name:"price",label:t("折扣/現金"),align:"center",sortable:!0},{name:"end_time",label:t("結束時間"),align:"center",sortable:!0},{name:"operate",label:t("操作"),align:"center"}],rows:[],selected:[],pagination:{sortBy:"id",descending:!1,page:1,rowsPerPage:10,rowsNumber:0}});let v=(0,o.qj)({info:""});(0,l.bv)((()=>{U({pagination:W.pagination})}));const U=({pagination:e})=>{let{page:t,rowsPerPage:a,sortBy:l,descending:n}=e;const o={page:t,page_size:a,sort_name:l,sort_order:n?0:1,search_info:v.info};k("/discount/discount_list",o,(e=>{"success"===e.status?(W.rows=e.info,W.pagination.rowsNumber=e?.pager?.p_rows??0,W.pagination.page=t,W.pagination.rowsPerPage=a,W.pagination.sortBy=l,W.pagination.descending=n):s.Z.create({message:e.message,position:"top",color:"negative"})}))},q=e=>{e&&a.dialog({title:t("刪除"),message:t("是否確認刪除")+"?",cancel:t("取消"),ok:t("確認"),persistent:!0}).onOk((()=>{k("/discount/discount_del",{id:e},(e=>{"success"===e.status?(1===W.rows.length&&W.pagination.page>1&&W.pagination.page--,U({pagination:W.pagination}),s.Z.create({message:e.message,position:"top",color:"positive"})):s.Z.create({message:e.message,position:"top",color:"negative"})}))}))},y=()=>{W.pagination.page=1,U({pagination:W.pagination})},Z=e=>{h.push(`/other/coupon/editcoupon/${e}`)},Q=()=>{let e=W.selected.map((e=>e.id));a.dialog({title:t("刪除"),message:t("是否確認刪除")+"?",cancel:t("取消"),ok:t("確認"),persistent:!0}).onOk((()=>{k("/discount/discount_all_del",{ids:e},(e=>{"success"===e.status?(1===W.rows.length&&W.pagination.page>1&&W.pagination.page--,W.selected.length=0,U({pagination:W.pagination}),s.Z.create({message:e.message,position:"top",color:"positive"})):s.Z.create({message:e.message,position:"top",color:"negative"})}))}))},V=()=>{v.info="",W.pagination.page=1,W.pagination.rowsNumber=0,W.pagination.sortBy="id",W.pagination.descending=!1,y()};let z=(0,l.Fl)((()=>W.selected.length>0));return(e,t)=>{const a=(0,l.up)("q-card-section"),s=(0,l.up)("q-btn"),r=(0,l.up)("q-icon"),p=(0,l.up)("q-input"),c=(0,l.up)("q-checkbox"),k=(0,l.up)("q-th"),h=(0,l.up)("q-tr"),C=(0,l.up)("q-td"),$=(0,l.up)("q-chip"),j=(0,l.up)("q-table"),x=(0,l.up)("q-card"),P=(0,l.up)("q-dialog"),T=(0,l.up)("q-page"),B=(0,l.Q2)("close-popup");return(0,l.wg)(),(0,l.j4)(T,{padding:""},{default:(0,l.w5)((()=>[(0,l.Wm)(x,null,{default:(0,l.w5)((()=>[(0,l.Wm)(a,null,{default:(0,l.w5)((()=>[(0,l._)("div",u,(0,n.zw)(e.$t("優惠券")),1)])),_:1}),(0,l.Wm)(a,null,{default:(0,l.w5)((()=>[(0,l._)("div",g,[(0,l._)("div",m,[(0,l.Wm)(s,{color:"secondary",onClick:V,label:e.$t("刷新")},null,8,["label"]),(0,l.Wm)(s,{to:"other/coupon/addcoupon",color:"primary",label:e.$t("新增")},null,8,["label"])]),(0,l._)("div",w,[(0,l.Wm)(p,{type:"search",modelValue:(0,o.SU)(v).info,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,o.SU)(v).info=e),label:e.$t("搜索"),outlined:"",dense:"",clearable:"",onKeydown:(0,i.D2)(y,["enter"]),onBlur:y},{append:(0,l.w5)((()=>[(0,l.Wm)(r,{name:"search"})])),_:1},8,["modelValue","label","onKeydown"])])]),(0,l.Wm)(j,{flat:"",rows:W.rows,columns:W.columns,"row-key":"id",pagination:W.pagination,"onUpdate:pagination":t[1]||(t[1]=e=>W.pagination=e),selection:"multiple",selected:W.selected,"onUpdate:selected":t[2]||(t[2]=e=>W.selected=e),"binary-state-sort":"",onRequest:U},{header:(0,l.w5)((t=>[(0,l.Wm)(h,{props:t},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{align:"center",width:"100"},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{modelValue:t.selected,"onUpdate:modelValue":e=>t.selected=e},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.cols,(a=>((0,l.wg)(),(0,l.j4)(k,{key:a.name,props:t},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(e.$t(a.label)),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props"])])),body:(0,l.w5)((t=>[(0,l.Wm)(h,{props:t},{default:(0,l.w5)((()=>[(0,l.Wm)(C,{align:"center",width:"100"},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{modelValue:t.selected,"onUpdate:modelValue":e=>t.selected=e},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),(0,l.Wm)(C,{align:"center"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(t.row.id),1)])),_:2},1024),(0,l.Wm)(C,{align:"center"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(t.row.title),1)])),_:2},1024),(0,l.Wm)(C,{align:"center"},{default:(0,l.w5)((()=>[1===t.row.status?((0,l.wg)(),(0,l.j4)($,{key:0,color:"positive","text-color":"white"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(e.$t("正常")),1)])),_:1})):0===t.row.status?((0,l.wg)(),(0,l.j4)($,{key:1,color:"negative","text-color":"white"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(e.$t("異常")),1)])),_:1})):(0,l.kq)("",!0)])),_:2},1024),(0,l.Wm)(C,{align:"center"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(t.row.type),1)])),_:2},1024),(0,l.Wm)(C,{align:"center"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(t.row.code),1)])),_:2},1024),(0,l.Wm)(C,{align:"center"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(t.row.price),1)])),_:2},1024),(0,l.Wm)(C,{align:"center"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(t.row.end_time),1)])),_:2},1024),(0,l.Wm)(C,{align:"center"},{default:(0,l.w5)((()=>[(0,l._)("div",b,[(0,l.Wm)(s,{color:"primary",label:e.$t("編輯"),onClick:e=>Z(t.row.id)},null,8,["label","onClick"]),(0,l.Wm)(s,{color:"negative",label:e.$t("刪除"),onClick:e=>q(t.row.id)},null,8,["label","onClick"])])])),_:2},1024)])),_:2},1032,["props"])])),bottom:(0,l.w5)((e=>[(0,l.Wm)((0,o.SU)(d.Z),{modelValue:e.pagination,"onUpdate:modelValue":[t=>e.pagination=t,U]},null,8,["modelValue","onUpdate:modelValue"])])),_:1},8,["rows","columns","pagination","selected"])])),_:1})])),_:1}),(0,l.Wm)(P,{"model-value":(0,o.SU)(z),"full-width":"",position:"bottom",seamless:""},{default:(0,l.w5)((()=>[(0,l.Wm)(x,null,{default:(0,l.w5)((()=>[(0,l.Wm)(a,{class:"row justify-between items-center"},{default:(0,l.w5)((()=>[(0,l._)("div",_,[(0,l.Uk)((0,n.zw)(e.$t("已選中"))+" ",1),(0,l._)("span",f,(0,n.zw)(W.selected.length),1),(0,l.Uk)(" "+(0,n.zw)(e.$t("項")),1)]),(0,l.wy)((0,l.Wm)(s,{unelevated:"",color:"negative",label:e.$t("批量刪除"),onClick:Q},null,8,["label"]),[[B]])])),_:1})])),_:1})])),_:1},8,["model-value"])])),_:1})}}};var h=a(9885),W=a(4458),v=a(3190),U=a(8879),q=a(6611),y=a(2857),Z=a(9497),Q=a(3532),V=a(1682),z=a(1221),C=a(7220),$=a(7691),j=a(2074),x=a(2146),P=a(9984),T=a.n(P);const B=k,S=B;T()(k,"components",{QPage:h.Z,QCard:W.Z,QCardSection:v.Z,QBtn:U.Z,QInput:q.Z,QIcon:y.Z,QTable:Z.Z,QTr:Q.Z,QTh:V.Z,QCheckbox:z.Z,QTd:C.Z,QChip:$.Z,QDialog:j.Z}),T()(k,"directives",{ClosePopup:x.Z});const D={__name:"Other",setup(e){return(e,t)=>((0,l.wg)(),(0,l.j4)(S))}},I=D,K=I}}]);
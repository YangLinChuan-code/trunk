"use strict";(globalThis["webpackChunktrunk"]=globalThis["webpackChunktrunk"]||[]).push([[313],{4895:(e,l,a)=>{a.r(l),a.d(l,{default:()=>ee});a(9665);var t=a(9835),o=a(499),n=a(6970),i=a(7712),s=a(9185),r=a(6827),c=a(9302),u=a(8339),d=a(5054),m=a(465),p=a(4746);a(1175);const g={class:"q-pa-sm"},w={class:"row justify-center items-center",style:{width:"150px",height:"150px",margin:"auto"}},b={class:"row q-gutter-sm q-mt-none"},_={__name:"Qrcode",setup(e){const{t:l}=(0,i.QT)(),a=(0,t.f3)("post"),n=(0,o.qj)({url:"",dataURL:"",visible:!1,ready:!1}),s=()=>{(0,d.Z)(n.url).then((()=>{r.Z.create({message:l("複製成功"),position:"top",color:"positive"})}))},c=()=>{n.visible=!0,k()},u=e=>{n.dataURL=e},_=()=>{const e=(0,m.v9)(n.dataURL,"qrcode.js");(0,m.LR)(URL.createObjectURL(e),(new Date).getTime()+".png")},U=()=>{n.url="",n.ready=!1},k=()=>{n.ready=!1,a("/customer/qrcode_code",{},(e=>{"success"===e.status?(n.url=`${location.origin}/#/prefill?id=${e.info}`,n.ready=!0):r.Z.create({message:e.message,position:"top",color:"negative"})}))};return(e,l)=>{const a=(0,t.up)("q-inner-loading"),i=(0,t.up)("q-btn"),r=(0,t.up)("q-popup-proxy"),d=(0,t.up)("q-icon");return(0,t.wg)(),(0,t.j4)(d,{name:e.$iconfont.qrcode,class:"cursor-pointer",size:"2rem",onClick:c},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{modelValue:n.visible,"onUpdate:modelValue":[l[0]||(l[0]=e=>n.visible=e),U],"no-parent-event":""},{default:(0,t.w5)((()=>[(0,t._)("div",g,[(0,t._)("div",w,[n.url?((0,t.wg)(),(0,t.j4)((0,o.SU)(p.Z),{key:0,callback:u,text:n.url,margin:0,size:300,style:{width:"100%"}},null,8,["text"])):(0,t.kq)("",!0),(0,t.Wm)(a,{showing:!n.ready,color:"primary",size:"2rem"},null,8,["showing"])]),(0,t._)("div",b,[(0,t.Wm)(i,{disable:!n.ready,color:"primary",size:"0.5rem",label:e.$t("下載"),onClick:_},null,8,["disable","label"]),(0,t.Wm)(i,{disable:!n.ready,color:"info",size:"0.5rem",label:e.$t("複製"),onClick:s},null,8,["disable","label"]),(0,t.Wm)(i,{disable:!n.ready,color:"positive",size:"0.5rem",label:e.$t("更新"),onClick:k},null,8,["disable","label"])])])])),_:1},8,["modelValue"])])),_:1},8,["name"])}}};var U=a(2857),k=a(2765),y=a(854),v=a(8879),W=a(9984),V=a.n(W);const f=_,q=f;V()(_,"components",{QIcon:U.Z,QPopupProxy:k.Z,QInnerLoading:y.Z,QBtn:v.Z});const h={class:"row justify-between items-center"},Z={key:0,class:"qrcode"},$={class:"row q-col-gutter-x-lg"},S={class:"row q-col-gutter-x-lg"},C={class:"row q-col-gutter-x-lg"},Q={class:"row q-gutter-x-lg"},z={class:"row q-mr-lg"},j={class:"q-gutter-x-sm"},x={class:"text-subtitle2"},P={class:"text-negative"},T={__name:"Customer",setup(e){const l=(0,c.Z)(),a=(0,u.tv)(),{t:d}=(0,i.QT)(),m=(0,t.f3)("post"),p=[{label:d("正式客戶"),value:0},{label:d("報價客戶"),value:1},{label:d("預填客戶"),value:2}],g=[{label:d("個人"),value:0},{label:d("公司"),value:1}],w=[{label:d("有效"),value:1},{label:d("無效"),value:0}],b=((0,o.iH)(w[0]),(0,o.qj)({columns:[{name:"id",label:"ID",align:"center",sortable:!0},{name:"code",label:d("客戶編號"),align:"center",sortable:!0},{name:"type",label:d("類別"),align:"center"},{name:"name",label:d("客戶名稱"),align:"center"},{name:"chineseName",label:d("中文名稱"),align:"center"},{name:"client_phone",label:d("手機號碼"),align:"center",sortable:!0},{name:"client_email",label:d("郵箱"),align:"center",sortable:!0},{name:"status",label:d("狀態"),align:"center",sortable:!0},{name:"create_time",label:d("建立時間"),align:"center",sortable:!0},{name:"operate",label:d("操作"),align:"center"}],rows:[],selected:[],pagination:{sortBy:"id",descending:!1,page:1,rowsPerPage:10,rowsNumber:0}}));let _=(0,o.qj)({type:"",user_type:0,id:"",code:"",option_type:"",ename:"",name:"",phone:"",email:"",status:1,create_time:""});(0,t.bv)((()=>{U({pagination:b.pagination})}));const U=({pagination:e})=>{let{page:l,rowsPerPage:a,sortBy:t,descending:o}=e;const n={page:l,page_size:a,sort_name:t,sort_order:o?0:1,..._};m("/customer/customer_list",n,(e=>{"success"===e.status?(b.rows=e.info,b.pagination.rowsNumber=e?.pager?.p_rows??0,b.pagination.page=l,b.pagination.rowsPerPage=a,b.pagination.sortBy=t,b.pagination.descending=o):r.Z.create({message:e.message,position:"top",color:"negative"})}))},k=()=>{b.pagination.page=1,b.pagination.total=0,U({pagination:b.pagination})},y=()=>{_.ename=_.type=_.id=_.code=_.option_type=_.email=_.name=_.phone=_.status=_.create_time="",b.pagination.page=1,b.pagination.rowsNumber=0,b.pagination.sortBy="id",b.pagination.descending=!1,k()},v=e=>{e&&l.dialog({title:d("刪除"),message:d("是否確認刪除")+"?",cancel:d("取消"),ok:d("確認"),persistent:!0}).onOk((()=>{m("/customer/customer_del",{id:e},(e=>{"success"===e.status?(1===b.rows.length&&b.pagination.page>1&&b.pagination.page--,U({pagination:b.pagination}),r.Z.create({message:e.message,position:"top",color:"positive"})):r.Z.create({message:e.message,position:"top",color:"negative"})}))}))},W=e=>{a.push(`/customer/editcustomer/${e}`)},V=e=>{a.push(`/customer/viewcustomer/${e}`)},f=()=>{let e=b.selected.map((e=>e.id));l.dialog({title:d("刪除"),message:d("是否確認刪除")+"?",cancel:d("取消"),ok:d("確認"),persistent:!0}).onOk((()=>{m("/customer/customer_all_del",{ids:e},(e=>{"success"===e.status?(1===b.rows.length&&b.pagination.page>1&&b.pagination.page--,b.selected.length=0,U({pagination:b.pagination}),r.Z.create({message:e.message,position:"top",color:"positive"})):r.Z.create({message:e.message,position:"top",color:"negative"})}))}))};let T=(0,t.Fl)((()=>b.selected.length>0));return(e,l)=>{const a=(0,t.up)("q-btn-toggle"),i=(0,t.up)("q-card-section"),r=(0,t.up)("q-input"),c=(0,t.up)("q-select"),u=(0,t.up)("date"),d=(0,t.up)("q-btn"),m=(0,t.up)("q-space"),B=(0,t.up)("q-checkbox"),L=(0,t.up)("q-th"),R=(0,t.up)("q-tr"),D=(0,t.up)("q-td"),I=(0,t.up)("q-chip"),N=(0,t.up)("q-table"),O=(0,t.up)("q-card"),F=(0,t.up)("q-form"),H=(0,t.up)("q-dialog"),K=(0,t.up)("q-page"),Y=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.j4)(K,{padding:""},{default:(0,t.w5)((()=>[(0,t.Wm)(F,null,{default:(0,t.w5)((()=>[(0,t.Wm)(O,null,{default:(0,t.w5)((()=>[(0,t.Wm)(i,null,{default:(0,t.w5)((()=>[(0,t._)("div",h,[(0,t.Wm)(a,{modelValue:(0,o.SU)(_).user_type,"onUpdate:modelValue":[l[0]||(l[0]=e=>(0,o.SU)(_).user_type=e),k],options:p},null,8,["modelValue"]),2===(0,o.SU)(_).user_type?((0,t.wg)(),(0,t.iD)("div",Z,[(0,t.Wm)((0,o.SU)(q))])):(0,t.kq)("",!0)])])),_:1}),(0,t.Wm)(i,{class:"q-gutter-y-lg"},{default:(0,t.w5)((()=>[(0,t._)("div",$,[(0,t.Wm)(r,{class:"col-4",label:"ID",outlined:"",dense:"",clearable:"",modelValue:(0,o.SU)(_).id,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,o.SU)(_).id=e)},null,8,["modelValue"]),(0,t.Wm)(r,{class:"col-4",label:e.$t("客戶編號"),outlined:"",dense:"",clearable:"",modelValue:(0,o.SU)(_).code,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,o.SU)(_).code=e)},null,8,["label","modelValue"]),(0,t.Wm)(c,{class:"col-4",modelValue:(0,o.SU)(_).option_type,"onUpdate:modelValue":l[3]||(l[3]=e=>(0,o.SU)(_).option_type=e),options:g,label:e.$t("類別"),"map-options":"","emit-value":"",outlined:"",dense:""},null,8,["modelValue","label"])]),(0,t._)("div",S,[(0,t.Wm)(r,{class:"col-4",label:e.$t("名稱"),outlined:"",dense:"",clearable:"",modelValue:(0,o.SU)(_).ename,"onUpdate:modelValue":l[4]||(l[4]=e=>(0,o.SU)(_).ename=e)},null,8,["label","modelValue"]),(0,t.Wm)(r,{class:"col-4",label:e.$t("中文名稱"),outlined:"",dense:"",clearable:"",modelValue:(0,o.SU)(_).name,"onUpdate:modelValue":l[5]||(l[5]=e=>(0,o.SU)(_).name=e)},null,8,["label","modelValue"]),(0,t.Wm)(r,{class:"col-4",label:e.$t("手機號碼"),outlined:"",dense:"",clearable:"",modelValue:(0,o.SU)(_).phone,"onUpdate:modelValue":l[6]||(l[6]=e=>(0,o.SU)(_).phone=e)},null,8,["label","modelValue"])]),(0,t._)("div",C,[(0,t.Wm)(r,{class:"col-4",label:e.$t("郵箱"),outlined:"",dense:"",clearable:"",modelValue:(0,o.SU)(_).email,"onUpdate:modelValue":l[7]||(l[7]=e=>(0,o.SU)(_).email=e)},null,8,["label","modelValue"]),(0,t.Wm)(c,{class:"col-4",modelValue:(0,o.SU)(_).status,"onUpdate:modelValue":l[8]||(l[8]=e=>(0,o.SU)(_).status=e),options:w,label:e.$t("狀態"),"map-options":"","emit-value":"",outlined:"",dense:""},null,8,["modelValue","label"]),(0,t.Wm)(u,{class:"col-4",label:e.$t("建立時間"),outlined:"",dense:"",clearable:"",modelValue:(0,o.SU)(_).create_time,"onUpdate:modelValue":l[9]||(l[9]=e=>(0,o.SU)(_).create_time=e)},null,8,["label","modelValue"])]),(0,t._)("div",Q,[(0,t.Wm)(d,{color:"primary",onClick:k,label:e.$t("搜索")},null,8,["label"]),(0,t.Wm)(d,{outline:"",color:"dark",onClick:y,label:e.$t("重置")},null,8,["label"])])])),_:1}),(0,t.Wm)(i,{class:"q-mt-lg"},{default:(0,t.w5)((()=>[(0,t._)("div",z,[(0,t.Wm)(m),(0,t.Wm)(d,{to:`customer/addcustomer?user_type=${(0,o.SU)(_).user_type}`,color:"primary",label:e.$t("新增")},null,8,["to","label"])])])),_:1}),(0,t.Wm)(i,null,{default:(0,t.w5)((()=>[(0,t.Wm)(N,{flat:"",rows:b.rows,columns:b.columns,"row-key":"id",pagination:b.pagination,"onUpdate:pagination":l[10]||(l[10]=e=>b.pagination=e),selection:"multiple",selected:b.selected,"onUpdate:selected":l[11]||(l[11]=e=>b.selected=e),"binary-state-sort":"",onRequest:U},{header:(0,t.w5)((e=>[(0,t.Wm)(R,{props:e},{default:(0,t.w5)((()=>[(0,t.Wm)(L,{align:"center",width:"100"},{default:(0,t.w5)((()=>[(0,t.Wm)(B,{modelValue:e.selected,"onUpdate:modelValue":l=>e.selected=l},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.cols,(l=>((0,t.wg)(),(0,t.j4)(L,{key:l.name,props:e},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(l.label),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props"])])),body:(0,t.w5)((l=>[(0,t.Wm)(R,{props:l},{default:(0,t.w5)((()=>[(0,t.Wm)(D,{align:"center",width:"100"},{default:(0,t.w5)((()=>[(0,t.Wm)(B,{modelValue:l.selected,"onUpdate:modelValue":e=>l.selected=e},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),(0,t.Wm)(D,{align:"center"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(l.row.id),1)])),_:2},1024),(0,t.Wm)(D,{align:"center"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(l.row.code),1)])),_:2},1024),(0,t.Wm)(D,{align:"center"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(0===l.row.type?"個人":"公司"),1)])),_:2},1024),(0,t.Wm)(D,{align:"center"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(0===l.row.type?l.row.client_register_ename:l.row.client_company_ename),1)])),_:2},1024),(0,t.Wm)(D,{align:"center"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(0===l.row.type?l.row.client_register_name:l.row.client_company_name),1)])),_:2},1024),(0,t.Wm)(D,{align:"center"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(l.row.client_phone),1)])),_:2},1024),(0,t.Wm)(D,{align:"center"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(l.row.client_email),1)])),_:2},1024),(0,t.Wm)(D,{align:"center"},{default:(0,t.w5)((()=>[1===l.row.status?((0,t.wg)(),(0,t.j4)(I,{key:0,color:"positive","text-color":"white"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(e.$t("有效")),1)])),_:1})):0===l.row.status?((0,t.wg)(),(0,t.j4)(I,{key:1,color:"negative","text-color":"white"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(e.$t("無效")),1)])),_:1})):(0,t.kq)("",!0)])),_:2},1024),(0,t.Wm)(D,{align:"center"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(l.row.create_time),1)])),_:2},1024),(0,t.Wm)(D,{align:"center"},{default:(0,t.w5)((()=>[(0,t._)("div",j,[0===l.row.status?((0,t.wg)(),(0,t.j4)(d,{key:0,disable:"",color:"secondary",label:e.$t("預覽"),onClick:e=>V(l.row.id)},null,8,["label","onClick"])):((0,t.wg)(),(0,t.j4)(d,{key:1,color:"secondary",label:e.$t("預覽"),onClick:e=>V(l.row.id)},null,8,["label","onClick"])),0===l.row.status?((0,t.wg)(),(0,t.j4)(d,{key:2,disable:"",color:"primary",label:e.$t("編輯"),onClick:e=>W(l.row.id)},null,8,["label","onClick"])):((0,t.wg)(),(0,t.j4)(d,{key:3,color:"primary",label:e.$t("編輯"),onClick:e=>W(l.row.id)},null,8,["label","onClick"])),0===l.row.status?((0,t.wg)(),(0,t.j4)(d,{key:4,disable:"",color:"negative",label:e.$t("刪除"),onClick:e=>v(l.row.id)},null,8,["label","onClick"])):((0,t.wg)(),(0,t.j4)(d,{key:5,color:"negative",label:e.$t("刪除"),onClick:e=>v(l.row.id)},null,8,["label","onClick"]))])])),_:2},1024)])),_:2},1032,["props"])])),bottom:(0,t.w5)((e=>[(0,t.Wm)((0,o.SU)(s.Z),{modelValue:e.pagination,"onUpdate:modelValue":[l=>e.pagination=l,U]},null,8,["modelValue","onUpdate:modelValue"])])),_:1},8,["rows","columns","pagination","selected"])])),_:1})])),_:1})])),_:1}),(0,t.Wm)(H,{"model-value":(0,o.SU)(T),"full-width":"",position:"bottom",seamless:""},{default:(0,t.w5)((()=>[(0,t.Wm)(O,null,{default:(0,t.w5)((()=>[(0,t.Wm)(i,{class:"row justify-between items-center"},{default:(0,t.w5)((()=>[(0,t._)("div",x,[(0,t.Uk)((0,n.zw)(e.$t("已選中"))+" ",1),(0,t._)("span",P,(0,n.zw)(b.selected.length),1),(0,t.Uk)(" "+(0,n.zw)(e.$t("項")),1)]),(0,t.wy)((0,t.Wm)(d,{unelevated:"",color:"negative",label:e.$t("批量刪除"),onClick:f},null,8,["label"]),[[Y]])])),_:1})])),_:1})])),_:1},8,["model-value"])])),_:1})}}};var B=a(9885),L=a(8326),R=a(4458),D=a(3190),I=a(1389),N=a(6611),O=a(2259),F=a(136),H=a(9497),K=a(3532),Y=a(1682),A=a(1221),E=a(7220),G=a(7691),J=a(2074),M=a(2146);const X=T,ee=X;V()(T,"components",{QPage:B.Z,QForm:L.Z,QCard:R.Z,QCardSection:D.Z,QBtnToggle:I.Z,QInput:N.Z,QSelect:O.Z,QBtn:v.Z,QSpace:F.Z,QTable:H.Z,QTr:K.Z,QTh:Y.Z,QCheckbox:A.Z,QTd:E.Z,QChip:G.Z,QDialog:J.Z}),V()(T,"directives",{ClosePopup:M.Z})}}]);
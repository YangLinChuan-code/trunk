"use strict";(globalThis["webpackChunktrunk"]=globalThis["webpackChunktrunk"]||[]).push([[460],{9305:(e,l,a)=>{a.r(l),a.d(l,{default:()=>N});a(9665);var t=a(9835),o=a(6970),n=a(499),s=a(7712),i=a(9185),u=a(6827),r=a(8339),d=a(3506);const c={class:"text-h6"},m={class:"row q-col-gutter-x-lg"},p={class:"row q-col-gutter-x-lg"},g={class:"row q-col-gutter-x-lg"},w={class:"row justify-between items-center"},b={class:"q-gutter-sm"},_={class:"q-gutter-x-sm"},v={class:"text-h6"},U={class:"row"},W={__name:"StorageUnit",setup(e){const l=(0,r.tv)(),{t:a}=((0,r.yj)(),(0,s.QT)()),W=[{label:a("可用"),value:0},{label:a("佔用"),value:1},{label:a("保留"),value:2},{label:a("鎖定"),value:3}],f=(0,t.f3)("post"),V=(0,n.qj)({columns:[{name:"name",label:a("倉庫"),align:"center",sortable:!0},{name:"extent",label:a("面積"),align:"center",sortable:!0},{name:"size",label:a("尺寸"),align:"center",sortable:!0},{name:"price",label:a("月費"),align:"center",sortable:!0},{name:"status",label:a("狀態"),align:"center",sortable:!0},{name:"end_time",label:a("結束日期"),align:"center",sortable:!0},{name:"customer",label:a("客戶"),align:"center"},{name:"operate",label:a("操作"),align:"center"}],rows:[],pagination:{sortBy:"id",descending:!0,page:1,rowsPerPage:10,rowsNumber:0}}),h=(0,n.iH)(!1);let k=(0,n.qj)({storehouse_id:"",status:"",extent_start:"",extent_end:"",price_start:"",price_end:""});(0,t.bv)((()=>{q({pagination:V.pagination})}));const $=(0,n.iH)({email:"",theme:"",content:""}),q=({pagination:e})=>{let{page:l,rowsPerPage:a,sortBy:t,descending:o}=e;const n={page:l,page_size:a,sort_name:t,sort_order:o?0:1,form:k};f("/storehouse/storehouse_list",n,(e=>{"success"===e.status?(V.rows=e.info,V.pagination.rowsNumber=e?.pager?.p_rows??0,V.pagination.page=l,V.pagination.rowsPerPage=a,V.pagination.sortBy=t,V.pagination.descending=o):u.Z.create({message:e.message,position:"top",color:"negative"})}))},y=()=>{V.pagination.page=1,V.pagination.total=0,q({pagination:V.pagination})},x=()=>{k.storehouse_id=k.status=k.extent_start=k.extent_end=k.price_start=k.price_end="",V.pagination.page=1,V.pagination.rowsNumber=0,V.pagination.sortBy="id",V.pagination.descending=!0,y()},Z=e=>{l.push(`/storageunit/edit/${e}`)},S=e=>{l.push(`/storageunit/view/${e}`)};let Q=(0,n.iH)(!1);const z=()=>{h.value=!0,f("/smtp/send_email",$.value,(e=>{"success"===e.status?(h.value=!0,Q.value=!1,u.Z.create({message:a("發送成功"),position:"top",color:"positive"})):u.Z.create({message:a("發送失敗"),position:"top",color:"negative"})}))},C=e=>{f("/smtp/smtp_template_info",{id:e},(e=>{"success"===e.status?($.value.email=e.info.email,$.value.theme=e.info.title,$.value.content=e.info.content,Q.value=!0):u.Z.create({message:a("發送失敗"),position:"top",color:"negative"})}))};return(e,l)=>{const a=(0,t.up)("q-card-section"),s=(0,t.up)("q-input"),u=(0,t.up)("q-select"),r=(0,t.up)("q-btn"),f=(0,t.up)("q-th"),j=(0,t.up)("q-tr"),P=(0,t.up)("q-td"),T=(0,t.up)("q-chip"),B=(0,t.up)("q-table"),H=(0,t.up)("q-card"),D=(0,t.up)("q-space"),I=(0,t.up)("q-form"),N=(0,t.up)("q-dialog"),F=(0,t.up)("q-page"),J=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.j4)(F,{padding:""},{default:(0,t.w5)((()=>[(0,t.Wm)(H,null,{default:(0,t.w5)((()=>[(0,t.Wm)(a,null,{default:(0,t.w5)((()=>[(0,t._)("div",c,(0,o.zw)(e.$t("倉庫單元")),1)])),_:1}),(0,t.Wm)(a,{class:"q-gutter-y-lg"},{default:(0,t.w5)((()=>[(0,t._)("div",m,[(0,t.Wm)(s,{class:"col-4",outlined:"",dense:"",clearable:"",label:e.$t("倉庫ID"),modelValue:(0,n.SU)(k).storehouse_id,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,n.SU)(k).storehouse_id=e)},null,8,["label","modelValue"]),(0,t.Wm)(u,{class:"col-4",outlined:"",dense:"",clearable:"",modelValue:(0,n.SU)(k).status,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,n.SU)(k).status=e),options:W,"emit-value":"","map-options":"",label:e.$t("狀態")},null,8,["modelValue","label"])]),(0,t._)("div",p,[(0,t.Wm)(s,{class:"col-4",outlined:"",dense:"",clearable:"",modelValue:(0,n.SU)(k).extent_start,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,n.SU)(k).extent_start=e),label:e.$t("面積")},null,8,["modelValue","label"]),(0,t.Wm)(s,{class:"col-4",outlined:"",dense:"",clearable:"",modelValue:(0,n.SU)(k).extent_end,"onUpdate:modelValue":l[3]||(l[3]=e=>(0,n.SU)(k).extent_end=e),label:e.$t("至")},null,8,["modelValue","label"])]),(0,t._)("div",g,[(0,t.Wm)(s,{class:"col-4",outlined:"",dense:"",clearable:"",modelValue:(0,n.SU)(k).price_start,"onUpdate:modelValue":l[4]||(l[4]=e=>(0,n.SU)(k).price_start=e),label:e.$t("每月的費用")},null,8,["modelValue","label"]),(0,t.Wm)(s,{class:"col-4",outlined:"",dense:"",clearable:"",modelValue:(0,n.SU)(k).price_end,"onUpdate:modelValue":l[5]||(l[5]=e=>(0,n.SU)(k).price_end=e),label:e.$t("至")},null,8,["modelValue","label"])]),(0,t._)("div",w,[(0,t._)("div",b,[(0,t.Wm)(r,{color:"primary",onClick:y,label:e.$t("搜索")},null,8,["label"]),(0,t.Wm)(r,{outline:"",color:"dark",onClick:x,label:e.$t("重置")},null,8,["label"])])])])),_:1}),(0,t.Wm)(a,null,{default:(0,t.w5)((()=>[(0,t.Wm)(B,{flat:"",rows:V.rows,columns:V.columns,"row-key":"id",pagination:V.pagination,"onUpdate:pagination":l[6]||(l[6]=e=>V.pagination=e),selection:"multiple",selected:V.selected,"onUpdate:selected":l[7]||(l[7]=e=>V.selected=e),"binary-state-sort":"",onRequest:q},{header:(0,t.w5)((e=>[(0,t.Wm)(j,{props:e},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.cols,(l=>((0,t.wg)(),(0,t.j4)(f,{key:l.name,props:e},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(l.label),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props"])])),body:(0,t.w5)((l=>[(0,t.Wm)(j,{props:l},{default:(0,t.w5)((()=>[(0,t.Wm)(P,{align:"center"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(l.row.name),1)])),_:2},1024),(0,t.Wm)(P,{align:"center"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(l.row.extent),1)])),_:2},1024),(0,t.Wm)(P,{align:"center"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(l.row.size),1)])),_:2},1024),(0,t.Wm)(P,{align:"center"},{default:(0,t.w5)((()=>[(0,t.Uk)("$"+(0,o.zw)(e.fmtCurrency(l.row.price)),1)])),_:2},1024),(0,t.Wm)(P,{align:"center"},{default:(0,t.w5)((()=>[0===l.row.status?((0,t.wg)(),(0,t.j4)(T,{key:0,color:"positive","text-color":"white"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(e.$t("可用")),1)])),_:1})):1===l.row.status?((0,t.wg)(),(0,t.j4)(T,{key:1,color:"negative","text-color":"white"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(e.$t("佔用")),1)])),_:1})):2===l.row.status?((0,t.wg)(),(0,t.j4)(T,{key:2,color:"warning","text-color":"white"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(e.$t("保留")),1)])),_:1})):3===l.row.status?((0,t.wg)(),(0,t.j4)(T,{key:3,color:"secondary","text-color":"white"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(e.$t("鎖定")),1)])),_:1})):(0,t.kq)("",!0)])),_:2},1024),(0,t.Wm)(P,{align:"center"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(l.row.end_time),1)])),_:2},1024),(0,t.Wm)(P,{align:"center"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(l.row.customer_name),1)])),_:2},1024),(0,t.Wm)(P,{align:"center"},{default:(0,t.w5)((()=>[(0,t._)("div",_,[(0,t.Wm)(r,{disable:0===l.row.status,color:"primary",label:e.$t("發送郵件"),onClick:e=>C(l.row.id)},null,8,["disable","label","onClick"]),(0,t.Wm)(r,{color:"secondary",label:e.$t("詳情"),onClick:e=>S(l.row.id)},null,8,["label","onClick"]),(0,t.Wm)(r,{color:"primary",onClick:e=>Z(l.row.id),label:e.$t("編輯")},null,8,["onClick","label"])])])),_:2},1024)])),_:2},1032,["props"])])),bottom:(0,t.w5)((e=>[(0,t.Wm)((0,n.SU)(i.Z),{modelValue:e.pagination,"onUpdate:modelValue":[l=>e.pagination=l,q]},null,8,["modelValue","onUpdate:modelValue"])])),_:1},8,["rows","columns","pagination","selected"])])),_:1})])),_:1}),(0,t.Wm)(N,{modelValue:(0,n.SU)(Q),"onUpdate:modelValue":l[11]||(l[11]=e=>(0,n.dq)(Q)?Q.value=e:Q=e)},{default:(0,t.w5)((()=>[(0,t.Wm)(H,{style:{"min-width":"600px","max-width":"1200px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(a,{class:"row items-center q-pb-none"},{default:(0,t.w5)((()=>[(0,t._)("div",v,(0,o.zw)(e.$t("發送郵件")),1),(0,t.Wm)(D),(0,t.wy)((0,t.Wm)(r,{icon:"close",flat:"",round:"",dense:""},null,512),[[J]])])),_:1}),(0,t.Wm)(a,null,{default:(0,t.w5)((()=>[(0,t.Wm)(I,{onSubmit:z},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{rules:[l=>(0,n.SU)(d.Jh)(l)||e.$t("請輸入正確郵箱")],dense:"",outlined:"",clearable:"",modelValue:$.value.email,"onUpdate:modelValue":l[8]||(l[8]=e=>$.value.email=e),label:e.$t("收件人")},null,8,["rules","modelValue","label"]),(0,t.Wm)(s,{rules:[l=>l&&l.length>0||e.$t("請輸入主題")],dense:"",outlined:"",clearable:"",modelValue:$.value.theme,"onUpdate:modelValue":l[9]||(l[9]=e=>$.value.theme=e),label:e.$t("主題")},null,8,["rules","modelValue","label"]),(0,t.Wm)(s,{class:"template",dense:"",outlined:"",clearable:"",modelValue:$.value.content,"onUpdate:modelValue":l[10]||(l[10]=e=>$.value.content=e),type:"textarea",label:e.$t("模板"),rules:[l=>l&&l.length>0||e.$t("請填寫模板")]},null,8,["modelValue","label","rules"]),(0,t._)("div",U,[(0,t.Wm)(D),(0,t.Wm)(r,{type:"submit",color:"primary",loading:h.value,label:e.$t("發送")},null,8,["loading","label"])])])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})}}};var f=a(1639),V=a(9885),h=a(4458),k=a(3190),$=a(6611),q=a(2259),y=a(8879),x=a(9497),Z=a(3532),S=a(1682),Q=a(7220),z=a(7691),C=a(2074),j=a(136),P=a(8326),T=a(8149),B=a(2146),H=a(9984),D=a.n(H);const I=(0,f.Z)(W,[["__scopeId","data-v-5ee7e13b"]]),N=I;D()(W,"components",{QPage:V.Z,QCard:h.Z,QCardSection:k.Z,QInput:$.Z,QSelect:q.Z,QBtn:y.Z,QTable:x.Z,QTr:Z.Z,QTh:S.Z,QTd:Q.Z,QChip:z.Z,QDialog:C.Z,QSpace:j.Z,QForm:P.Z,QField:T.Z}),D()(W,"directives",{ClosePopup:B.Z})}}]);
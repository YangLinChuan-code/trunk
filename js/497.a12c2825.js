"use strict";(globalThis["webpackChunktrunk"]=globalThis["webpackChunktrunk"]||[]).push([[497],{7737:(e,l,a)=>{a.r(l),a.d(l,{default:()=>B});a(9665);var t=a(9835),n=a(6970),o=a(499),i=a(8339),s=a(9185),r=a(6827),d=a(9302),u=a(7712);const c={class:"row q-col-gutter-xl"},m={class:"row q-col-gutter-xl"},p={class:"row q-col-gutter-xl"},g={class:"row q-gutter-x-lg"},w={class:"row justify-end q-gutter-lg q-mr-lg"},_={class:"row justify-center q-gutter-sm"},b={class:"text-subtitle2"},k={class:"text-negative"},W={__name:"Index",setup(e){const{t:l}=(0,u.QT)(),a=(0,i.tv)(),W=(0,t.f3)("post"),f=(0,d.Z)(),q=(0,o.qj)({start_time:"",end_time:"",client_name:"",client_telephone:"",order_num:""}),v=(0,o.qj)({rows:[],columns:[{name:"id",label:"ID",align:"center",sortable:!0},{name:"order_num",label:l("報價單編號"),align:"center",sortable:!0},{name:"client_register_ename",label:l("客戶名稱"),align:"center"},{name:"client_telephone",label:l("聯繫電話"),align:"center",sortable:!0},{name:"create_time",label:l("建立時間"),align:"center",sortable:!0},{name:"expected_lease_time",label:l("預計搬入時間"),align:"center",sortable:!0},{name:"operate",label:l("操作"),align:"center"}],selected:[],pagination:{sortBy:"id",descending:!1,page:1,rowsPerPage:10,rowsNumber:0}});(0,t.bv)((()=>{h({pagination:v.pagination})}));const h=({pagination:e})=>{let{page:l,rowsPerPage:a,sortBy:t,descending:n}=e;const o={page:l,page_size:a,sort_name:t,sort_order:n?0:1,search_info:q};W("/quote/quote_list",o,(e=>{"success"===e.status?(v.rows=e.info,v.pagination.rowsNumber=e?.pager?.p_rows??0,v.pagination.page=l,v.pagination.rowsPerPage=a,v.pagination.sortBy=t,v.pagination.descending=n):r.Z.create({message:e.message,position:"top",color:"negative"})}))},V=()=>{v.pagination.page=1,h({pagination:v.pagination})},U=e=>{e&&f.dialog({title:l("刪除"),message:l("是否確認刪除")+"?",cancel:l("取消"),ok:l("確認"),persistent:!0}).onOk((()=>{W("/quote/del_quote",{id:e},(e=>{"success"===e.status?(1===v.rows.length&&v.pagination.page>1&&v.pagination.page--,h({pagination:v.pagination}),r.Z.create({message:e.message,position:"top",color:"positive"})):r.Z.create({message:e.message,position:"top",color:"negative"})}))}))},y=e=>{a.push(`/quotation/view/${e}`)},Z=e=>{a.push(`quotation/edit/${e}`)},$=()=>{let e=v.selected.map((e=>e.id));f.dialog({title:l("刪除"),message:l("是否確認刪除")+"?",cancel:l("取消"),ok:l("確認"),persistent:!0}).onOk((()=>{W("/quote/quote_all_del",{ids:e},(e=>{"success"===e.status?(1===v.rows.length&&v.pagination.page>1&&v.pagination.page--,v.selected.length=0,h({pagination:v.pagination}),r.Z.create({message:e.message,position:"top",color:"positive"})):r.Z.create({message:e.message,position:"top",color:"negative"})}))}))},C=()=>{q.start_time=q.end_time=q.client_name=q.client_telephone=q.order_num="",v.pagination.page=1,v.pagination.rowsNumber=0,v.pagination.sortBy="id",v.pagination.descending=!1,V()};let Q=(0,t.Fl)((()=>v.selected.length>0));return(e,l)=>{const a=(0,t.up)("date"),i=(0,t.up)("q-input"),r=(0,t.up)("q-btn"),d=(0,t.up)("q-form"),u=(0,t.up)("q-card-section"),W=(0,t.up)("q-checkbox"),f=(0,t.up)("q-th"),z=(0,t.up)("q-tr"),x=(0,t.up)("q-td"),j=(0,t.up)("q-table"),P=(0,t.up)("q-card"),T=(0,t.up)("q-dialog"),B=(0,t.up)("q-page"),D=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.j4)(B,{padding:""},{default:(0,t.w5)((()=>[(0,t.Wm)(P,null,{default:(0,t.w5)((()=>[(0,t.Wm)(u,null,{default:(0,t.w5)((()=>[(0,t.Wm)(d,{class:"q-col-gutter-lg"},{default:(0,t.w5)((()=>[(0,t._)("div",c,[(0,t.Wm)(a,{class:"col-5",label:e.$t("週期"),outlined:"",dense:"",clearable:"",modelValue:q.start_time,"onUpdate:modelValue":l[0]||(l[0]=e=>q.start_time=e)},null,8,["label","modelValue"]),(0,t.Wm)(a,{class:"col-5",label:e.$t("至"),outlined:"",dense:"",clearable:"",modelValue:q.end_time,"onUpdate:modelValue":l[1]||(l[1]=e=>q.end_time=e)},null,8,["label","modelValue"])]),(0,t._)("div",m,[(0,t.Wm)(i,{class:"col-5",outlined:"",dense:"",clearable:"",modelValue:q.client_name,"onUpdate:modelValue":l[2]||(l[2]=e=>q.client_name=e),label:e.$t("客戶名稱")},null,8,["modelValue","label"]),(0,t.Wm)(i,{class:"col-5",outlined:"",dense:"",clearable:"",modelValue:q.client_telephone,"onUpdate:modelValue":l[3]||(l[3]=e=>q.client_telephone=e),label:e.$t("聯繫電話"),type:"tel"},null,8,["modelValue","label"])]),(0,t._)("div",p,[(0,t.Wm)(i,{class:"col-5",outlined:"",dense:"",clearable:"",modelValue:q.order_num,"onUpdate:modelValue":l[4]||(l[4]=e=>q.order_num=e),label:e.$t("報價單編號")},null,8,["modelValue","label"])]),(0,t._)("div",g,[(0,t.Wm)(r,{color:"primary",onClick:V,label:e.$t("搜索")},null,8,["label"]),(0,t.Wm)(r,{outline:"",color:"dark",onClick:C,label:e.$t("重置")},null,8,["label"])])])),_:1})])),_:1}),(0,t.Wm)(u,null,{default:(0,t.w5)((()=>[(0,t._)("div",w,[(0,t.Wm)(r,{color:"primary",unelevated:"",label:e.$t("新增"),to:"/quotation/add/0"},null,8,["label"])])])),_:1}),(0,t.Wm)(u,null,{default:(0,t.w5)((()=>[(0,t.Wm)(j,{flat:"",rows:v.rows,columns:v.columns,"row-key":"id",pagination:v.pagination,"onUpdate:pagination":l[5]||(l[5]=e=>v.pagination=e),selection:"multiple",selected:v.selected,"onUpdate:selected":l[6]||(l[6]=e=>v.selected=e),"binary-state-sort":"",onRequest:h},{header:(0,t.w5)((e=>[(0,t.Wm)(z,{props:e},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{align:"center",width:"100"},{default:(0,t.w5)((()=>[(0,t.Wm)(W,{modelValue:e.selected,"onUpdate:modelValue":l=>e.selected=l},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.cols,(l=>((0,t.wg)(),(0,t.j4)(f,{key:l.name,props:e},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(l.label),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props"])])),body:(0,t.w5)((l=>[(0,t.Wm)(z,{props:l},{default:(0,t.w5)((()=>[(0,t.Wm)(x,{align:"center",width:"100"},{default:(0,t.w5)((()=>[(0,t.Wm)(W,{modelValue:l.selected,"onUpdate:modelValue":e=>l.selected=e},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),(0,t.Wm)(x,{align:"center"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(l.row.id),1)])),_:2},1024),(0,t.Wm)(x,{align:"center"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(l.row.order_num),1)])),_:2},1024),1===l.row.type?((0,t.wg)(),(0,t.j4)(x,{key:0,align:"center"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(l.row.client_company_ename),1)])),_:2},1024)):((0,t.wg)(),(0,t.j4)(x,{key:1,align:"center"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(l.row.client_register_ename),1)])),_:2},1024)),(0,t.Wm)(x,{align:"center"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(l.row.client_telephone),1)])),_:2},1024),(0,t.Wm)(x,{align:"center"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(l.row.create_time),1)])),_:2},1024),(0,t.Wm)(x,{align:"center"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(l.row.expected_lease_time),1)])),_:2},1024),(0,t.Wm)(x,{align:"center"},{default:(0,t.w5)((()=>[(0,t._)("div",_,[(0,t.Wm)(r,{color:"secondary",unelevated:"",onClick:e=>y(l.row.id),label:e.$t("預覽")},null,8,["onClick","label"]),(0,t.Wm)(r,{color:"primary",onClick:e=>Z(l.row.id),unelevated:"",label:e.$t("編輯")},null,8,["onClick","label"]),(0,t.Wm)(r,{color:"negative",unelevated:"",onClick:e=>U(l.row.id),label:e.$t("刪除")},null,8,["onClick","label"])])])),_:2},1024)])),_:2},1032,["props"])])),bottom:(0,t.w5)((e=>[(0,t.Wm)((0,o.SU)(s.Z),{modelValue:e.pagination,"onUpdate:modelValue":[l=>e.pagination=l,h]},null,8,["modelValue","onUpdate:modelValue"])])),_:1},8,["rows","columns","pagination","selected"])])),_:1})])),_:1}),(0,t.Wm)(T,{"model-value":(0,o.SU)(Q),"full-width":"",position:"bottom",seamless:""},{default:(0,t.w5)((()=>[(0,t.Wm)(P,null,{default:(0,t.w5)((()=>[(0,t.Wm)(u,{class:"row justify-between items-center"},{default:(0,t.w5)((()=>[(0,t._)("div",b,[(0,t.Uk)((0,n.zw)(e.$t("已選中"))+" ",1),(0,t._)("span",k,(0,n.zw)(v.selected.length),1),(0,t.Uk)((0,n.zw)(e.$t("項")),1)]),(0,t.wy)((0,t.Wm)(r,{unelevated:"",color:"negative",label:e.$t("批量刪除"),onClick:$},null,8,["label"]),[[D]])])),_:1})])),_:1})])),_:1},8,["model-value"])])),_:1})}}};var f=a(9885),q=a(4458),v=a(3190),h=a(8326),V=a(6611),U=a(8879),y=a(9497),Z=a(3532),$=a(1682),C=a(1221),Q=a(7220),z=a(2074),x=a(2146),j=a(9984),P=a.n(j);const T=W,B=T;P()(W,"components",{QPage:f.Z,QCard:q.Z,QCardSection:v.Z,QForm:h.Z,QInput:V.Z,QBtn:U.Z,QTable:y.Z,QTr:Z.Z,QTh:$.Z,QCheckbox:C.Z,QTd:Q.Z,QDialog:z.Z}),P()(W,"directives",{ClosePopup:x.Z})}}]);